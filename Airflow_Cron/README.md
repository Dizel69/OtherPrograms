# Настройка и использование Apache Airflow для создания cron-job

## Шаг 1: Установка Apache Airflow

### Установка с помощью pip

1. Убедитесь, что у вас установлен Python 3.6 или выше. Проверьте это командой:
    python --version

2. Установите pip, если он еще не установлен. Проверьте это командой:
    pip --version

    Если же pip не установлен, выполните команду:
    python -m ensurepip --upgrade

4. Установите Apache Airflow:
    pip install apache-airflow

## Шаг 2: Настройка проекта Airflow

1. Создайте директорию для Airflow:
    mkdir -p ~/airflow/dags

2. Перейдите в эту директорию:
    cd ~/airflow

## Шаг 3: Создание DAG (Directed Acyclic Graph)

1. В директории `~/airflow/dags` создайте новый файл `my_cron_job.py`:
    touch ~/airflow/dags/my_cron_job.py

2. Откройте файл `my_cron_job.py` в текстовом редакторе (например, nano, vim или VSCode) и вставьте туда код;

## Шаг 4: Инициализация базы данных и запуск Airflow

1. Инициализируйте базу данных Airflow:
    airflow db init
    
2. Запустите веб-сервер Airflow:
    airflow webserver --port 8080

    Важно: Оставьте этот терминал открытым и запущенным.

3. В новом терминале запустите планировщик Airflow:
    airflow scheduler

    Оставьте этот терминал также открытым и запущенным.

## Шаг 5: Использование веб-интерфейса Airflow

1. Откройте браузер и перейдите по адресу: [http://localhost:8080]
2. В веб-интерфейсе вы увидите ваш DAG с именем `my_cron_dag`.
3. Активируйте DAG, переключив тумблер в положение "включено".
4. Запустите DAG вручную для проверки, нажав на "Trigger Dag" (иконка молнии).

## Шаг 6: Проверка результатов

1. Перейдите в раздел "Graph View" вашего DAG.
2. Вы увидите граф задач. Нажмите на задачу `my_task` и выберите "View Log", чтобы увидеть вывод вашей задачи.

## Заключение

Поздравляю теперь у вас настроен Airflow и создана простая задача по расписанию, которая имитирует cron-job. Вы можете изменять расписание, задачи и добавлять новые.
Удачи!